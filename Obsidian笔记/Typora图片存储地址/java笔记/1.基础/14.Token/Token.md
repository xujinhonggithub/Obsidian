<h1 align = "center">Token</h1>

# 1. Token 

## 1.1  流程图

前端登录之后，后台服务生成唯一的令牌，一份存在Redis数据库，一份返回前端存储

下次访问需要登陆权限的功能，需要携带令牌

![image-20210427100018910](../../../图片/image-20210427100018910.png)

### 1.1.1 后端的逻辑处理

第一次登录存到redis , 返回到前端

![image-20210427110614475](../../../图片/image-20210427110614475.png)

前端请求  过滤器过滤中书写

![image-20210427142326553](../../../图片/image-20210427142326553.png)

使用psotman测试  需要在请求头加上token

![image-20210427143120273](../../../图片/image-20210427143120273.png)

每次通过token 验证,之后刷新token的时间  ,不能让用户在使用过程中 退出登录

![image-20210427145034863](../../../图片/image-20210427145034863.png)

### 1.1.2  前端的逻辑处理  localstroage  

永久存储 除非删除

登录后 存储 token

![image-20210427152030809](../../../图片/image-20210427152030809.png)

需要token的请求 封装了公共方法, 请求头 headers 携带token,使用时自带token

![image-20210427155806761](../../../图片/image-20210427155806761.png)

报错的话可以看看过滤器  允许跨域的请求 加上token

![image-20210427160144966](../../../图片/image-20210427160144966.png)

### 1.1.3  退出登录  删除redis 中的token

![image-20210427163306043](../../../图片/image-20210427163306043.png)

测试注销功能

![image-20210427163652955](../../../图片/image-20210427163652955.png)

### 1.1.4  删除 前端 localstroage  的 token

![image-20210427163940011](../../../图片/image-20210427163940011.png)



## 1.2  商城案例

前端用户登陆 传递手机号和验证码

![image-20210427101830555](../../../图片/image-20210427101830555.png)

调用后台的方法 最终生成token 存入缓存

![image-20210427103131979](../../../图片/image-20210427103131979.png)

将携带token 的会员信息返回前端

![image-20210427103256291](../../../图片/image-20210427103256291.png)

![image-20210427101515340](../../../图片/image-20210427101515340.png)

需要使用时候判断

![image-20210427105420925](../../../图片/image-20210427105420925.png)